<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Primary Meta Tags -->
        <title>Lars Erik Schonander</title>
        <meta name="title" content="Lars Erik Schonander">
        <meta name="description" content="Personal writing, links, and other miscellanea by Lars Erik Schonander. ">

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://www.larserikschonander.com/">
        <meta property="og:title" content="Lars Erik Schonander">
        <meta property="og:description" content="Personal writing, links, and other miscellanea by Lars Erik Schonander. ">
        <meta property="og:image" content>

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image">
        <meta property="twitter:url" content="https://www.larserikschonander.com/">
        <meta property="twitter:title" content="Lars Erik Schonander">
        <meta property="twitter:description" content="Personal writing, links, and other miscellanea by Lars Erik Schonander. ">
        <meta property="twitter:image" content>
        <link rel="stylesheet" href="../css/default.css" />
        <link rel="shortcut icon" href="../images/icon_HSn_icon.ico" type="image/x-icon" />
        <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-121467707-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-121467707-1');
    </script>
    </head>
    <body>  
        <h1 id="name">Lars E. Schonander</h1>
        <header>
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            
        </header>

        <main role="main">
            <h1>Two Useful JavaScript Pointers</h1>
            <article>
    <section class="header">
        Posted on November 10, 2018
        
    </section>
    <section>
        <pre><code>    &gt; Epistemic status: This is erm... a technical post. </code></pre>
<p>JavaScript, while a sometimes hard to deal with language, does have some features as of late, mainly from ES6, that make the language nicer to deal with. Here are two examples that I have found particularly useful, and hopefully should prove useful to others as well.</p>
<h3 id="flatmap">FlatMap</h3>
<p>A relatively new functional programming feature in JavaScript is the <code>flatMap</code> function. As in the name, it not only applies a mapped function to an array, but it also flattens the array as well. In other words, it is a combination of the <code>.flat()</code> function and the <code>.map()</code> function. For example, look at this code snippet below:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">let</span> ar <span class="op">=</span> [[<span class="dv">1</span>]<span class="op">,</span> [<span class="dv">2</span>]<span class="op">,</span> [<span class="dv">3</span>]<span class="op">,</span> [<span class="dv">4</span>]<span class="op">,</span> [<span class="dv">5</span>]]</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="va">ar</span>.<span class="at">flatMap</span>(x <span class="op">=&gt;</span> [x <span class="op">*</span> <span class="dv">2</span>])<span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">// [5, 10, 15, 20, 25]</span></a></code></pre></div>
<p>While what this does is simple, instead of with map each result becomes an array, the array turns a single array with all the values in it getting the mapped function applied to it. As stated in the function name, the array is not only getting mapped, but flattened as well. Another example is combining arrays filled with strings into a single array. First above the usual map, and then the usage of <code>flatMap</code> instead:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">let</span> arv <span class="op">=</span> [<span class="st">&quot;How are&quot;</span><span class="op">,</span> <span class="st">&quot;you&quot;</span><span class="op">,</span> <span class="st">&quot;right now&quot;</span><span class="op">,</span> <span class="st">&quot;?&quot;</span>]</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="va">arv</span>.<span class="at">map</span>(x <span class="op">=&gt;</span> <span class="va">x</span>.<span class="at">split</span>(<span class="st">&quot; &quot;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">// [[&quot;How&quot;, &quot;are&quot;],[&quot;you&quot;],[&quot;right&quot;, &quot;now&quot;], [&quot;?&quot;]]</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">//versus the flatmap result</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="va">arv</span>.<span class="at">flatMap</span>(x <span class="op">=&gt;</span> <span class="va">x</span>.<span class="at">split</span>(<span class="st">&quot; &quot;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">// [&quot;How&quot;, &quot;are&quot;, &quot;you&quot;, &quot;right&quot;, &quot;now&quot;, &quot;?&quot;]</span></a></code></pre></div>
<p>As seen, unlike with the usual map function, the array is flattened, making the data is easier to work with then in general. This function is useful for working with GeoJSON data and making sure the data is flat and not nested.</p>
<p>For example, I was working with a CSV sheet and the rows were roughly filled like this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">let</span> data <span class="op">=</span> [<span class="st">&quot;-34.57 77.567&quot;</span><span class="op">,</span> <span class="st">&quot;-36.54 84.26&quot;</span>]</a></code></pre></div>
<p>While usually I could use Regex to clean this up, turns out flatMap also does a good job of converting the data into the format I wanted. As seen below:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="va">data</span>.<span class="at">flatMap</span>(_ <span class="op">=&gt;</span> [<span class="va">_</span>.<span class="at">split</span>(<span class="st">&quot; &quot;</span>)])</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">// [[&quot;-34.57&quot;, &quot;77.567&quot;], [&quot;-36.54&quot;, &quot;84.26&quot;]]</span></a></code></pre></div>
<p>Now the data is much easier to work with when it comes converting the values into GeoJSON points to put on a map.</p>
<h3 id="es6-and-d3.js">ES6 and D3.js</h3>
<p><a href="https://d3js.org">D3.js</a> is a famous and useful library for creating data visualizations in the browser. With ES6 in most browsers, some of the benefits of modern syntax can be used to make D3.js code easier to read and less sprawling.</p>
<p>To give an example, instead of writing out a whole function for the <code>.attr()</code> function, arrow functions can be used instead! An example below:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" data-line-number="1">.<span class="at">attr</span>(<span class="st">'x'</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="op">=&gt;</span> <span class="at">xScale</span>(i) <span class="op">+</span> <span class="dv">45</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">.<span class="at">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d) <span class="op">=&gt;</span> h <span class="op">-</span> <span class="at">yScale</span>(d) <span class="op">-</span> <span class="dv">10</span>)</a></code></pre></div>
<p>Instead of writing out a complete <code>function(d, i){...}</code>, the usage of arrow functions can keep the code on a single line.</p>
<p>Another way ES6 makes D3.js programming easier in general is the usage of template literals. Instead of doing the usual JavaScript method of chaining <code>+</code> signs together to concatenate strings, one can use template literals to run JavaScript code when for example, setting styles.</p>
<p>To again give an example, here are some template literals being used in the context of adding styles to elements:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" data-line-number="1">.<span class="at">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>h <span class="op">-</span> padding <span class="op">+</span> <span class="dv">10</span><span class="sc">}</span><span class="vs">)`</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">.<span class="at">attr</span>(<span class="st">'fill'</span><span class="op">,</span> (d) <span class="op">=&gt;</span> <span class="vs">`rgb(</span><span class="sc">${</span><span class="va">Math</span>.<span class="at">round</span>(d / <span class="dv">15</span>)<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="va">Math</span>.<span class="at">round</span>(d / <span class="fl">12.5</span>)<span class="sc">}</span><span class="vs">,0)`</span>)</a></code></pre></div>
<p>In general, much cleaner then having a mess of <code>&quot;&quot;</code> and <code>+</code> signs everywhere.</p>
<p>Hopefully these examples might prove helpful to others.</p>
    </section>
</article>

        </main>

        <footer>
            Site proudly built with 
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
            <br>
            Follow me at:
            <a href="https://twitter.com/LarsESchonander">@LarsESchonander</a>
        </footer>
    </body>
</html>
